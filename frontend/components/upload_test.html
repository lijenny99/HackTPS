<!DOCTYPE HTML>
<html>

<head>
</head>

<body>
    <!--multiple is set to allow multiple files to be selected-->

    <input id="myfiles" multiple type="file">

</body>
<script src="https://www.gstatic.com/firebasejs/5.0.4/firebase.js"></script>
<script>
    // Initialize Firebase
    // TODO: Replace with your project's customized code snippet
    const config = {
        apiKey: "AIzaSyDWTeVZ1QRE5BeEQ8yjiu_LNtzon9BoA1g",
        authDomain: "hacktps-2bc24.firebaseapp.com",
        databaseURL: "https://hacktps-2bc24.firebaseio.com",
        projectId: "hacktps-2bc24",
        storageBucket: "hacktps-2bc24.appspot.com",
        messagingSenderId: "357270015514"
    };
    firebase.initializeApp(config);
</script>

<script>
    const storage = firebase.storage();

    let storageRef = storage.ref();

    function upload_recording(file) {
        /*
        Available references needed:
        file.name();
        file.size();
        file.type();
        */
        let folderRef = storageRef.child("recordings");
        let fileRef = folderRef.child(file.name);
        let metadata = {
            contentType: file.type,
            name: file.name,
            size: file.size
        };

        let uploadTask = fileRef.put(file).then((snapshot) => {
            console.log(`File with details ${metadata} uploaded!`);
        }).catch((err) => {
            console.log(`Error ${err}`);
        })

    }

    var pullfiles = function () {
        // love the query selector
        var fileInput = document.querySelector("#myfiles");
        var files = fileInput.files;
        // cache files.length 
        var fl = files.length;
        var i = 0;

        while (i < fl) {
            // localize file var in the loop
            var file = files[i];

            alert(file.name);
            upload_recording(file);
            i++;
        }
    }

    // set the input element onchange to call pullfiles
    document.querySelector("#myfiles").onchange = pullfiles;

//a.t
</script>

</html>